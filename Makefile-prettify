
SRC_DIR := ./source
SRC_HIGHLIGHTED_DIR := ./html-highlighted-source

BMINUS_SRC:= $(wildcard $(SRC_DIR)/*.h) $(wildcard $(SRC_DIR)/*.c)
BMINUS_HIGHLIGHTED_SRC:= $(addprefix $(SRC_HIGHLIGHTED_DIR)/, $(notdir $(BMINUS_SRC)))

all: $(BMINUS_HIGHLIGHTED_SRC)

$(BMINUS_HIGHLIGHTED_SRC):
	echo '<script src="https://google-code-prettify.googlecode.com/svn/loader/run_prettify.js"></script>' >$@.html
	echo '<pre class="prettyprint"><code class="language-c">' >>$@.html
	perl -e 'use CGI qw(escapeHTML); while(<>) { print(escapeHTML($$_)); }' <$(SRC_DIR)/$(notdir $@) >>$@.html
	echo '</code></pre>' >>$@.html


